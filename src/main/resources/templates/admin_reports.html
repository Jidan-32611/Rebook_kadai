<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>通報一覧 | 管理者</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
  <main class="container admin-page">

    <h1>商品通報一覧</h1>

    <div class="toolbar">
		<a th:href="@{/admin/users}"
		   class="button secondary"
		   th:if="${#authorization.expression('hasRole(''ADMIN'')')}">
		  ユーザー管理に戻る
		</a>

      <p class="hint">未対応の通報を優先的に確認してください。</p>
    </div>

<table class="table">
    <thead>
    <tr>
        <th>ID</th>
        <th>商品名</th>
        <th>理由</th>
        <th>通報者</th>
        <th>通報日時</th>
        <th>状態</th>
        <th>確認</th>
    </tr>
    </thead>

    <tbody>
    <tr th:each="report : ${reports}">
        <td th:text="${report.id}"></td>

        <td>
            <a th:href="@{/items/{id}(id=${report.item.id})}"
               th:text="${report.item.name}">
            </a>
        </td>

        <td th:text="${report.reason}"></td>

        <td th:text="${report.reporter.name}"></td>

        <td th:text="${#temporals.format(report.createdAt, 'yyyy/MM/dd HH:mm')}"></td>

        <td>
			<form th:if="${report.status == '未対応'}"
			      th:action="@{/admin/reports/{id}/resolve(id=${report.id})}"
			      method="post">
			  <input type="hidden"
			         th:name="${_csrf.parameterName}"
			         th:value="${_csrf.token}">
					 <button type="submit"
					         onclick="return confirm('この通報を対応済にしますか？');">
					   対応済にする
					 </button>

			</form>

			      

				  <span class="tag tag-ok" th:if="${report.status == '対応済'}">
				    対応済
				  </span>

        </td>

        <td>
			<a th:href="@{/admin/users/{id}(id=${report.item.seller.id})}"
			   class="button secondary">
			  詳細
			</a>

        </td>
    </tr>
    </tbody>
</table>
</main>

</body>
</html>
